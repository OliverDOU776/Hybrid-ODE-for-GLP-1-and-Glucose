# Synthetic Metabolic Dataset Generation

This repository contains the code to generate a synthetic dataset simulating metabolic dynamics related to GLP-1-mediated glucose regulation. The dataset is used in paper **A Hybrid ODE-Neural Network Framework for Modeling and Guiding GLP-1-Mediated Glucose Dynamics** accepted by Nature Scientific Report. The model is inspired by the 4GI model and incorporates key physiological variables:
- **Glucose** (mmol/L)
- **Insulin** (ÂµU/mL)
- **Glucagon** (pg/mL)
- **Free Fatty Acids (FFA)** (mmol/L)
- **Gastric Emptying Rate** (mL/min)
- **Gastric Inhibitory Polypeptide (GIP)** (pg/mL)

## Overview

The synthetic dataset is generated by solving a system of ordinary differential equations (ODEs) that model the interactions between these variables. Key features of the simulation include:
- **Realistic Meal Input:** A Gaussian function models meal ingestion with a peak around 30 minutes.
- **Measurement Noise:** Gaussian noise is added to the simulated data to mimic experimental measurement error.
- **Physiologically-Inspired Parameters:** The model uses parameter values derived from the literature.

## Files

- **`generate_dataset.py`**: Main Python script that:
  - Defines the metabolic ODE system.
  - Simulates the system over a 5-hour (300-minute) period.
  - Adds Gaussian noise to the simulation outputs.
  - Saves the generated dataset as `synthetic_metabolic_data.csv`.
  - Plots the simulated trajectories for each variable.
  
- **`synthetic_metabolic_data.csv`**: (Generated when you run the script) Contains the synthetic dataset with columns for Time, Glucose, Insulin, Glucagon, FFA, GastricEmptying, and GIP.

## Requirements

- **Python 3.x**
- Python libraries:
  - `numpy`
  - `scipy`
  - `matplotlib`
  - `pandas`

Install the required packages using pip:

```bash
pip install numpy scipy matplotlib pandas
```
## Usage

1. **Clone the Repository or Download the Files:**
   Download `generate_dataset.py` and (optionally) the accompanying README.

2. **Run the Script:**

   ```bash
   python generate_dataset.py
   ```

3. **Output:**
   - The script will simulate the metabolic dynamics over a 5-hour period.
   - A CSV file named `synthetic_metabolic_data.csv` will be generated in the working directory.
   - Plots will be displayed showing both the noise-free (true) trajectories and the noisy (observed) data for each variable.

## Customization

- **Simulation Time:** Adjust the simulation time range in the `sim_time` variable.
- **Initial Conditions:** Modify the initial state vector `y0` as needed.
- **Parameter Values:** Change the values in the `params` dictionary to explore different physiological scenarios.
- **Noise Level:** Modify the `noise_std` parameter in the `simulate_metabolic_model` function to simulate different measurement error levels.


## Contact

For questions or suggestions, please contact Zijia Wang at zijia.wang18@imperial.ac.uk.

